\section{Related Work}

\paragraph{Design Tools for Quadrotor Camera Trajectories}

Several tools exist for designing quadrotor camera trajectories.
These tools allow users to place waypoints on a 2D map~\cite{apm:2015,dji:2015} or in a 3D virtual environment~\cite{meier:2012,joubert:2015,gebhardt:2016}.
Other tools allow users to interactively control the speed and orientation of a quadrotor camera as it flies along a pre-determined trajectory~\cite{3drobotics:2015,dji:2015a,joubert:2015}. 
However, most existing tools do not reason explicitly about the quadrotor dynamics, and therefore do not offer any assurance that the user's intended shot is feasible.

%\cite{3drobotics:2015,apm:2015,dji:2015a,dji:2015,meier:2012}

The shot planning tool introduced in Chapter~\ref{sec:ch2} computes velocities and control forces along a user-specified trajectory, notifying the user if her shot is infeasible. However, this tool offers no guidance on how to modify the shot to make it feasible.
The tool introduced by Gebhardt et al.~\shortcite{gebhardt:2016} optimizes quadrotor camera trajectories subject to velocity and control force limits, and is therefore capable of generating feasible trajectories.
However, this tool uses an approximate linear model of the quadrotor dynamics, which is only accurate for conservative trajectories.
In contrast, our algorithm reasons explicitly about the non-linear quadrotor dynamics, and is applicable to aggressive trajectories that are at a quadrotor's physical limits.

Using existing tools, a simple strategy for capturing an infeasible shot would be to uniformly time-stretch the shot until it is feasible, and then time-warp the resulting video footage back to the original timing.
However, this strategy is only applicable in completely static scenes.
For example, if a person is walking through the scene, then their walking motion will be time-warped, which may be visually jarring.

%However, this tool optimizes the spatial layout of the user's intended trajectory, not the timing, and is therefore not guaranteed to find a dynamically feasible solution.
%Moreover, this tool uses an approximate linear model of the quadrotor dynamics, which is only accurate for conservative trajectories.
%In contrast, our algorithm is guaranteed to find a dynamically feasible re-timing of the user's intended trajectory, without disturbing its visual contents or spatial layout.
%Moreover, our algorithm reasons explicitly about the non-linear quadrotor dynamics, and is applicable to aggressive trajectories that are at a quadrotor's physical limits.

\paragraph{Trajectory Optimization Methods for Quadrotors}

%These spline-based methods take advantage of the fact that all $C^4$ continuous trajectories satisfy the non-linear quadrotors dynamics.
%However, the trajectories generated by these methods are not guaranteed to remain within velocity and control force limits.

The most common approach for optimizing quadrotor trajectories is to generate $C^4$ continuous splines that minimize some kind of bending energy~\cite{mellinger:2011,bry:2015,deits:2015,joubert:2015}.
These spline-based trajectories can be adapted to remain within velocity and control force limits by optimizing the time allocated to each spline segment~\cite{mellinger:2011,bry:2015}.
However, this approach can result in overly conservative trajectories in cases where a long spline segment is only briefly infeasible.
In contrast, our algorithm optimally re-times trajectories at the level of individual samples along a path, rather than at the level of spline segments, resulting in trajectories that more closely match a user's intended timing.

More general non-convex optimization methods have been applied to generate feasible quadrotor trajectories.
Similar to our approach in this paper, some of these methods explicitly optimize a progress curve~\cite{cowling:2007,bouktir:2008,vanloock:2013}.
However, these methods focus on finding the fastest or most fuel-efficient trajectory that reaches a goal, and typically also optimize the spatial layout of the trajectory.
In contrast, we treat the spatial layout of the trajectory as fixed, and we focus on finding the progress curve that most closely matches a user's input.

\paragraph{Trajectory Optimization Methods in Computer Graphics and Robotics}

The problem of optimizing trajectories for dynamical systems has been studied extensively in the computer  graphics literature~\cite{geijtenbeek:2012}, and in the robotics literature~\cite{betts:1998}.
A common approach in both communities is to discretize a trajectory into a sequence of system states, and encode the system dynamics into an optimization problem as a set of equality constraints.
%Optimal trajectories can then be found by minimizing an objective (e.g., control effort, or disagreement with a reference trajectory) subject to the equality constraints.
This approach is known as \emph{spacetime constraints} in the computer graphics community~\cite{witkins:1988}, and \emph{direct collocation} in the robotics community~\cite{betts:1998}.
We refer the reader to Fang and Pollard~\shortcite{fang:2003} and Safonova et al.~\shortcite{safonova:2004} for a detailed overview of spacetime constraints approaches in computer graphics.
A well-known limitation of spacetime constraints is that it slow to converge for highly non-linear systems, such as quadrotors.
In contrast, our approach avoids this slow convergence behavior, due to our analysis of the non-linear quadrotor dynamics along a fixed path.

Trajectory optimization problems along a fixed path have been studied in the computer graphics literature~\cite{mccann:2006}, and even more extensively in the robotics literature~\cite{shin:1985,slotine:1989,dahl:1990,verscheure:2009,lipp:2014}.
Existing methods require a path through a system's full \emph{configuration space} as input, and optimize the speed of the system along this path.
However, these methods are not applicable to quadrotors.
This is because a quadrotor's orientation must match the direction in which it is accelerating.
Therefore, it is generally not possible for a quadrotor to travel at different speeds along the same path through configuration space.
In contrast, our algorithm is applicable to quadrotors.
This is because we only require a path through \emph{camera pose space} as input, and a quadrotor (equipped with an appropriate camera gimbal) is free to travel at different speeds along such a path.

Faulwasser et al.~\shortcite{faulwasser:2014} present a theoretical analysis of fixed path optimization problems for \emph{differentially flat} systems, a general class of dynamical systems to which quadrotors belong.
Our analysis of the quadrotor dynamics builds on this previous analysis, by applying it to the problem of matching a user-specified progress curve as closely as possible.       
